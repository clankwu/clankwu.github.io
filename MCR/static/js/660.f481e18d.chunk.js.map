{"version":3,"file":"static/js/660.f481e18d.chunk.js","mappings":"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","sources":["UI/Item.jsx","pages/List.jsx"],"sourcesContent":["import style from \"../assets/css/index.module.scss\";\nexport default function Item(props) {\n  return (\n    <div\n      className={style.item}\n      {...props}\n      style={{\n        background: `url(${props.thumb_url}) no-repeat`,\n        backgroundSize: \"cover\",\n      }}\n    >\n      <div className={style.circ}>\n        <div>当前分数</div>\n        <div>{props.children || \"未评\"}分</div>\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Item from \"../UI/Item\";\nimport style from \"../assets/css/index.module.scss\";\nimport top from \"../assets/images/list_top.png\";\nimport FingerprintJS from \"@fingerprintjs/fingerprintjs\";\nconst List = () => {\n  // const Item = React.lazy(() => import(\"../UI/Item\"));\n  const [state, setState] = useState({\n    fingerprint: \"\",\n    list: [],\n    score: [],\n    status: 0,\n  });\n  const nav = useNavigate();\n  useEffect(() => {\n    const local = JSON.parse(localStorage.getItem(\"state\"));\n    const { fingerprint, list, score } = local || state;\n\n    if (fingerprint && list && score) {\n      setState(local);\n    } else {\n      const queue = [];\n      queue.push(FingerprintJS.load().then((fp) => fp.get()));\n      queue.push(fetch(\"./list.json\").then((request) => request.json()));\n      queue.push(fetch(\"./score.json\").then((request) => request.json()));\n      Promise.all(queue).then((result) => {\n        const newState = {\n          fingerprint: result[0].visitorId,\n          list: result[1],\n          score: result[2].score,\n          status: 0,\n        };\n        if (result[2].score.length === 0) {\n          let count = result[1].length;\n          while (count--) result[2].score.push([0, 0, 0, 0]);\n          newState.status = 0;\n        } else {\n          newState.status = 2;\n        }\n        setState(newState);\n        localStorage.setItem(\"state\", JSON.stringify(newState));\n      });\n    }\n  }, []);\n\n  const itemClick = (index) => {\n    nav(\"/detail\", {\n      state: {\n        detail: state.list[index],\n        score: state.score[index],\n        status: state.status,\n      },\n    });\n    window.scrollTo({\n      left: 0,\n      top: 0,\n      behavior: \"smooth\",\n    });\n  };\n  const continueHandle = (e) => {\n    if (state.status === 0) {\n      const next = state.score.findIndex(\n        (item) => item.reduce((pre, cur) => pre + cur) === 0\n      );\n      nav(\"/detail\", {\n        state: {\n          detail: state.list[next],\n          score: state.score[next],\n          status: state.status,\n        },\n      });\n      window.scrollTo({\n        left: 0,\n        top: 0,\n        behavior: \"smooth\",\n      });\n    } else if (state.status === 1) {\n      if (window.confirm(\"是否提交您的评分？\")) {\n        fetch(\"./score.json\")\n          .then((request) => request.json())\n          .then((result) => {\n            console.log(result);\n            const newState = {\n              fingerprint: state.fingerprint,\n              list: state.list,\n              score: state.score,\n              status: 2,\n            };\n            setState(newState);\n            localStorage.setItem(\"state\", JSON.stringify(newState));\n          });\n      }\n    }\n\n    e.preventDefault();\n  };\n  return (\n    <div className={style.list}>\n      <img src={top} className={style.logo} alt=\"top\" />\n      <div className={style.listcontainer}>\n        {state.list.map((item, i) => (\n          <Item\n            key={i}\n            className={style.item}\n            onClick={() => {\n              itemClick(i);\n            }}\n            thumb_url={item.thumb_url}\n          >\n            {state.score[i]?.reduce((pre, cur) => pre + cur, 0)}\n          </Item>\n        ))}\n        <div\n          style={{ display: state.list.length ? \"block\" : \"none\" }}\n          className={style.tip}\n        >\n          请按顺序评分\n        </div>\n        <Link\n          id=\"complete\"\n          style={{\n            display: state.list.length ? \"block\" : \"none\",\n          }}\n          className={[\n            style.button,\n            state.status === 2 ? style.disabled : \"\",\n          ].join(\" \")}\n          to=\"/\"\n          onClick={continueHandle}\n        >\n          {[\"继续评分\", \"提交评价\", \"已提交\"][state.status]}\n        </Link>\n      </div>\n    </div>\n  );\n};\nexport default List;\n"],"names":["Item","props","className","style","background","thumb_url","backgroundSize","children","useState","fingerprint","list","score","status","state","setState","nav","useNavigate","useEffect","local","JSON","parse","localStorage","getItem","queue","push","FingerprintJS","then","fp","get","fetch","request","json","Promise","all","result","newState","visitorId","length","count","setItem","stringify","src","top","alt","map","item","i","onClick","index","detail","window","scrollTo","left","behavior","reduce","pre","cur","display","id","join","to","e","next","findIndex","confirm","console","log","preventDefault"],"sourceRoot":""}